"""
Binance Derivatives Trading Options WebSocket Market Streams

OpenAPI Specification for the Binance Derivatives Trading Options WebSocket Market Streams
The version of the OpenAPI document: 1.0.0
Generated by OpenAPI Generator (https://openapi-generator.tech)

Do not edit the class manually.
"""

from binance_common.errors import RequiredError
from binance_common.utils import ws_streams_placeholder
from binance_common.websocket import (
    WebSocketStreamBase,
    RequestStream,
    RequestStreamHandle,
)

from ..models import IndexPriceStreamsResponse
from ..models import KlineCandlestickStreamsResponse
from ..models import MarkPriceResponse
from ..models import NewSymbolInfoResponse
from ..models import OpenInterestResponse


from typing import Optional, Union


class MarketApi:
    """Client for MarketApi endpoints."""

    def __init__(self, websocket_base: WebSocketStreamBase) -> None:
        self.websocket_base = websocket_base

    async def index_price_streams(
        self,
        id: Optional[int] = None,
    ) -> RequestStreamHandle:
        r"""
            Index Price Streams
            /!index@arr
            https://developers.binance.com/docs/derivatives/options-trading/websocket-market-streams/Index-Price-Streams

            Underlying(e.g ETHUSDT) index stream.

        Update Speed: 1000ms

            Args:
                    id (Optional[int] = None): Unique WebSocket request ID.

            Returns:
                RequestStreamHandle

            Raises:
                RequiredError: If a required parameter is missing.

        """

        stream = ws_streams_placeholder(
            "/!index@arr".replace("/", "", 1),
            {
                "id": id,
            },
        )

        return await RequestStream(
            self.websocket_base,
            stream=stream,
            response_model=IndexPriceStreamsResponse,
            stream_url="market",
        )

    async def kline_candlestick_streams(
        self,
        symbol: Union[str, None],
        interval: Union[str, None],
        id: Optional[int] = None,
    ) -> RequestStreamHandle:
        r"""
            Kline/Candlestick Streams
            /<symbol>@kline_<interval>
            https://developers.binance.com/docs/derivatives/options-trading/websocket-market-streams/Kline-Candlestick-Streams

            The Kline/Candlestick Stream push updates to the current klines/candlestick every 1000 milliseconds (if existing).

        Update Speed: 1000ms

            Args:
                    symbol (Union[str, None]): The symbol parameter
                    interval (Union[str, None]): The interval parameter
                    id (Optional[int] = None): Unique WebSocket request ID.

            Returns:
                RequestStreamHandle

            Raises:
                RequiredError: If a required parameter is missing.

        """

        if symbol is None:
            raise RequiredError(
                field="symbol", error_message="Missing required parameter 'symbol'"
            )
        if interval is None:
            raise RequiredError(
                field="interval", error_message="Missing required parameter 'interval'"
            )

        stream = ws_streams_placeholder(
            "/<symbol>@kline_<interval>".replace("/", "", 1),
            {
                "symbol": symbol,
                "interval": interval,
                "id": id,
            },
        )

        return await RequestStream(
            self.websocket_base,
            stream=stream,
            response_model=KlineCandlestickStreamsResponse,
            stream_url="market",
        )

    async def mark_price(
        self,
        underlying: Union[str, None],
        id: Optional[int] = None,
    ) -> RequestStreamHandle:
        r"""
            Mark Price
            /<underlying>@optionMarkPrice
            https://developers.binance.com/docs/derivatives/options-trading/websocket-market-streams/Mark-Price

            The mark price for all option symbols on specific underlying asset. E.g.[btcusdt@optionMarkPrice](wss://fstream.binance.com/market/stream?streams=btcusdt@optionMarkPrice)

        Update Speed: 1000ms

            Args:
                    underlying (Union[str, None]): The underlying parameter
                    id (Optional[int] = None): Unique WebSocket request ID.

            Returns:
                RequestStreamHandle

            Raises:
                RequiredError: If a required parameter is missing.

        """

        if underlying is None:
            raise RequiredError(
                field="underlying",
                error_message="Missing required parameter 'underlying'",
            )

        stream = ws_streams_placeholder(
            "/<underlying>@optionMarkPrice".replace("/", "", 1),
            {
                "underlying": underlying,
                "id": id,
            },
        )

        return await RequestStream(
            self.websocket_base,
            stream=stream,
            response_model=MarkPriceResponse,
            stream_url="market",
        )

    async def new_symbol_info(
        self,
        id: Optional[int] = None,
    ) -> RequestStreamHandle:
        r"""
            New Symbol Info
            /!optionSymbol
            https://developers.binance.com/docs/derivatives/options-trading/websocket-market-streams/New-Symbol-Info

            New symbol listing stream.

        Update Speed: 50ms

            Args:
                    id (Optional[int] = None): Unique WebSocket request ID.

            Returns:
                RequestStreamHandle

            Raises:
                RequiredError: If a required parameter is missing.

        """

        stream = ws_streams_placeholder(
            "/!optionSymbol".replace("/", "", 1),
            {
                "id": id,
            },
        )

        return await RequestStream(
            self.websocket_base,
            stream=stream,
            response_model=NewSymbolInfoResponse,
            stream_url="market",
        )

    async def open_interest(
        self,
        expiration_date: Union[str, None],
        id: Optional[int] = None,
    ) -> RequestStreamHandle:
        r"""
            Open Interest
            /underlying@optionOpenInterest@<expirationDate>
            https://developers.binance.com/docs/derivatives/options-trading/websocket-market-streams/Open-Interest

            Option open interest for specific underlying asset on specific expiration date. E.g.[ethusdt@openInterest@221125](wss://fstream.binance.com/market/stream?streams=ethusdt@openInterest@221125)

        Update Speed: 60s

            Args:
                    expiration_date (Union[str, None]): The expirationDate parameter
                    id (Optional[int] = None): Unique WebSocket request ID.

            Returns:
                RequestStreamHandle

            Raises:
                RequiredError: If a required parameter is missing.

        """

        if expiration_date is None:
            raise RequiredError(
                field="expiration_date",
                error_message="Missing required parameter 'expiration_date'",
            )

        stream = ws_streams_placeholder(
            "/underlying@optionOpenInterest@<expirationDate>".replace("/", "", 1),
            {
                "expiration_date": expiration_date,
                "id": id,
            },
        )

        return await RequestStream(
            self.websocket_base,
            stream=stream,
            response_model=OpenInterestResponse,
            stream_url="market",
        )
